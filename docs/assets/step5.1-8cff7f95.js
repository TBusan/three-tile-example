import"./modulepreload-polyfill-3cfb730f.js";import{V as s,r as w,G as M,e as f,B as S,h as v,b as g,P as C,T as b,g as B,aC as L,ac as _,a as F,d as D}from"./mapSource-2c762b60.js";import{g as G}from"./lil-gui.module.min-a1e98589.js";import{c as P,a as V,u as I,e as T,s as z,b as E}from"./util-e741174c.js";const n=P([F]),x=n.geo2pos(new s(105,34)),U=new s(x.x,x.y,0),k=new s(0,-5e3,1e4),t=V("#map",U,k);t.scene.add(n);t.scene.background=new w(0);n.addEventListener("tile-loaded",a=>{a.tile.material.forEach(o=>{var e;return(e=o.color)==null?void 0:e.set(new w(8947848))})});const H=(a,o,e)=>{const r=n.geo2pos(new s(a.x,a.y)),d=n.geo2pos(new s(o.x,o.y)),p=new s(d.x-r.x,d.y-r.y,1),y=new s(r.x+p.x/2,d.y-p.y/2,e),u=new D;return u.setPosition(y),u.scale(p),u},c=((a,o)=>{const e=new M;e.applyMatrix4(H(a,o,1)),e.scale.setZ(200),e.translateZ(100),e.renderOrder=10;const r=new f(new S),d=new v(r,16711935);return e.add(d),e})(new g(67,11),new g(140,57)),l=(()=>{const a=new f(new C(1,1,529,420),O({scale:.5}));return N(a,"../image/SATE_L1_F2G_VISSR_MWB_NOM_FDI-202107241900.HDF.png"),a})();c.add(l);t.scene.add(c);const h=new G,i=h.addFolder("卫星云图");i.add(c.scale,"z",100,500,1).name("垂直拉伸").onChange(a=>c.position.z=a/2);i.addColor(l.material,"color").name("颜色");i.add(l.material,"opacity",.1,1,.1).name("透明度");i.add(l.material,"wireframe").name("网格");const m=h.addFolder("环境设置");m.addColor(t.ambLight,"color").name("环境光颜色");m.add(t.ambLight,"intensity",0,5,.1).name("环境光强度");m.addColor(t.dirLight,"color").name("直射光颜色");m.add(t.dirLight,"intensity",0,5,.1).name("直射光强度");function N(a,o){var e;return(e=a.material.map)==null||e.dispose(),a.material.map=new b().load(o,r=>{r.needsUpdate=!0}),a}function O(a={scale:1}){const o=new B({displacementMap:new L,transparent:!0,displacementScale:a.scale,displacementBias:0,side:_,opacity:.6,color:new w(13421772)});return o.onBeforeCompile=e=>{e.vertexShader=`uniform sampler2D map;
        `+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * displacementScale + displacementBias );"),e.fragmentShader=e.fragmentShader.replace("#include <alphamap_fragment>",`
            #include <alphamap_fragment>
            float h = texture2D(map, vMapUv ).a;
            diffuseColor.rgb *= h;
            diffuseColor.a = clamp(diffuseColor.a * 2.0, 0.0, 1.0);
            `)},o}I(t);T(n);z(t,n);E(n);
